{% extends 'Vault/base.html' %}
{% load static %}

{% block content %}
    <h1>Uploaded Files</h1>

    {% if files %}
        <ul>
            {% for file in files %}
                <li>
                    <!-- Display the file name with a link to download -->
                    <a href="{% url 'download_file' file.id %}">
                        {{ file.file.name|slice:":-4" }} <!-- Display the file name without the extension -->
                    </a>
                    
                    <!-- Display the upload date and time -->
                    (Uploaded at: {{ file.uploaded_at|date:"Y-m-d H:i" }})

                    <!-- Password form for file download -->
                    <form method="POST" action="{% url 'download_file' file.id %}">
                        {% csrf_token %}
                        <label for="password_{{ file.id }}">Enter Password:</label>
                        <input type="password" name="password" id="password_{{ file.id }}" placeholder="Password" required />
                        <button type="submit">Download</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No files uploaded yet.</p>
    {% endif %}
{% endblock %}

{% block extra_js %}
    <script src="{% static 'Vault/js/file_download.js' %}"></script>
{% endblock %}
